import{p as B,t as K,c as j,r as W,d as o,a as G,b as V,e as q}from"./cubing-icons-HW4AtzYa.js";var $;(function(t){var n=function(){function r(){this._dropEffect="move",this._effectAllowed="all",this._data={}}return Object.defineProperty(r.prototype,"dropEffect",{get:function(){return this._dropEffect},set:function(e){this._dropEffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectAllowed",{get:function(){return this._effectAllowed},set:function(e){this._effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"types",{get:function(){return Object.keys(this._data)},enumerable:!0,configurable:!0}),r.prototype.clearData=function(e){e!=null?delete this._data[e]:this._data=null},r.prototype.getData=function(e){return this._data[e]||""},r.prototype.setData=function(e,i){this._data[e]=i},r.prototype.setDragImage=function(e,i,l){var s=a._instance;s._imgCustom=e,s._imgOffset={x:i,y:l}},r}();t.DataTransfer=n;var a=function(){function r(){if(this._lastClick=0,r._instance)throw"DragDropTouch instance already created.";var e=!1;if(document.addEventListener("test",function(){},{get passive(){return e=!0,!0}}),"ontouchstart"in document){var i=document,l=this._touchstart.bind(this),s=this._touchmove.bind(this),u=this._touchend.bind(this),p=e?{passive:!1,capture:!1}:!1;i.addEventListener("touchstart",l,p),i.addEventListener("touchmove",s,p),i.addEventListener("touchend",u),i.addEventListener("touchcancel",u)}}return r.getInstance=function(){return r._instance},r.prototype._touchstart=function(e){var i=this;if(this._shouldHandle(e)){if(Date.now()-this._lastClick<r._DBLCLICK&&this._dispatchEvent(e,"dblclick",e.target)){e.cancelable&&e.preventDefault(),this._reset();return}this._reset();var l=this._closestDraggable(e.target);l&&!this._dispatchEvent(e,"mousemove",e.target)&&!this._dispatchEvent(e,"mousedown",e.target)&&(this._dragSource=l,this._ptDown=this._getPoint(e),this._lastTouch=e,e.cancelable&&e.preventDefault(),setTimeout(function(){i._dragSource==l&&i._img==null&&i._dispatchEvent(e,"contextmenu",l)&&i._reset()},r._CTXMENU),r._ISPRESSHOLDMODE&&(this._pressHoldInterval=setTimeout(function(){i._isDragEnabled=!0,i._touchmove(e)},r._PRESSHOLDAWAIT)))}},r.prototype._touchmove=function(e){if(this._shouldCancelPressHoldMove(e)){this._reset();return}if(this._shouldHandleMove(e)||this._shouldHandlePressHoldMove(e)){var i=this._getTarget(e);if(this._dispatchEvent(e,"mousemove",i)){this._lastTouch=e,e.cancelable&&e.preventDefault();return}this._dragSource&&!this._img&&this._shouldStartDragging(e)&&(this._dispatchEvent(e,"dragstart",this._dragSource),this._createImage(e),this._dispatchEvent(e,"dragenter",i)),this._img&&(this._lastTouch=e,e.cancelable&&e.preventDefault(),i!=this._lastTarget&&(this._dispatchEvent(this._lastTouch,"dragleave",this._lastTarget),this._dispatchEvent(e,"dragenter",i),this._lastTarget=i),this._moveImage(e),this._isDropZone=this._dispatchEvent(e,"dragover",i))}},r.prototype._touchend=function(e){if(this._shouldHandle(e)){if(this._dispatchEvent(this._lastTouch,"mouseup",e.target)){e.cancelable&&e.preventDefault();return}this._img||(this._dragSource=null,this._dispatchEvent(this._lastTouch,"click",e.target),this._lastClick=Date.now()),this._destroyImage(),this._dragSource&&(e.type.indexOf("cancel")<0&&this._isDropZone&&this._dispatchEvent(this._lastTouch,"drop",this._lastTarget),this._dispatchEvent(this._lastTouch,"dragend",this._dragSource),this._reset())}},r.prototype._shouldHandle=function(e){return e&&!e.defaultPrevented&&e.touches&&e.touches.length<2},r.prototype._shouldHandleMove=function(e){return!r._ISPRESSHOLDMODE&&this._shouldHandle(e)},r.prototype._shouldHandlePressHoldMove=function(e){return r._ISPRESSHOLDMODE&&this._isDragEnabled&&e&&e.touches&&e.touches.length},r.prototype._shouldCancelPressHoldMove=function(e){return r._ISPRESSHOLDMODE&&!this._isDragEnabled&&this._getDelta(e)>r._PRESSHOLDMARGIN},r.prototype._shouldStartDragging=function(e){var i=this._getDelta(e);return i>r._THRESHOLD||r._ISPRESSHOLDMODE&&i>=r._PRESSHOLDTHRESHOLD},r.prototype._reset=function(){this._destroyImage(),this._dragSource=null,this._lastTouch=null,this._lastTarget=null,this._ptDown=null,this._isDragEnabled=!1,this._isDropZone=!1,this._dataTransfer=new n,clearInterval(this._pressHoldInterval)},r.prototype._getPoint=function(e,i){return e&&e.touches&&(e=e.touches[0]),{x:i?e.pageX:e.clientX,y:i?e.pageY:e.clientY}},r.prototype._getDelta=function(e){if(r._ISPRESSHOLDMODE&&!this._ptDown)return 0;var i=this._getPoint(e);return Math.abs(i.x-this._ptDown.x)+Math.abs(i.y-this._ptDown.y)},r.prototype._getTarget=function(e){for(var i=this._getPoint(e),l=document.elementFromPoint(i.x,i.y);l&&getComputedStyle(l).pointerEvents=="none";)l=l.parentElement;return l},r.prototype._createImage=function(e){this._img&&this._destroyImage();var i=this._imgCustom||this._dragSource;if(this._img=i.cloneNode(!0),this._copyStyle(i,this._img),this._img.style.top=this._img.style.left="-9999px",!this._imgCustom){var l=i.getBoundingClientRect(),s=this._getPoint(e);this._imgOffset={x:s.x-l.left,y:s.y-l.top},this._img.style.opacity=r._OPACITY.toString()}this._moveImage(e),document.body.appendChild(this._img)},r.prototype._destroyImage=function(){this._img&&this._img.parentElement&&this._img.parentElement.removeChild(this._img),this._img=null,this._imgCustom=null},r.prototype._moveImage=function(e){var i=this;requestAnimationFrame(function(){if(i._img){var l=i._getPoint(e,!0),s=i._img.style;s.position="absolute",s.pointerEvents="none",s.zIndex="999999",s.left=Math.round(l.x-i._imgOffset.x)+"px",s.top=Math.round(l.y-i._imgOffset.y)+"px"}})},r.prototype._copyProps=function(e,i,l){for(var s=0;s<l.length;s++){var u=l[s];e[u]=i[u]}},r.prototype._copyStyle=function(e,i){if(r._rmvAtts.forEach(function(v){i.removeAttribute(v)}),e instanceof HTMLCanvasElement){var l=e,s=i;s.width=l.width,s.height=l.height,s.getContext("2d").drawImage(l,0,0)}for(var u=getComputedStyle(e),p=0;p<u.length;p++){var m=u[p];m.indexOf("transition")<0&&(i.style[m]=u[m])}i.style.pointerEvents="none";for(var p=0;p<e.children.length;p++)this._copyStyle(e.children[p],i.children[p])},r.prototype._dispatchEvent=function(e,i,l){if(e&&l){var s=document.createEvent("Event"),u=e.touches?e.touches[0]:e;return s.initEvent(i,!0,!0),s.button=0,s.which=s.buttons=1,this._copyProps(s,e,r._kbdProps),this._copyProps(s,u,r._ptProps),s.dataTransfer=this._dataTransfer,l.dispatchEvent(s),s.defaultPrevented}return!1},r.prototype._closestDraggable=function(e){for(;e;e=e.parentElement)if(e.hasAttribute("draggable")&&e.draggable)return e;return null},r}();a._instance=new a,a._THRESHOLD=5,a._OPACITY=.5,a._DBLCLICK=500,a._CTXMENU=900,a._ISPRESSHOLDMODE=!1,a._PRESSHOLDAWAIT=400,a._PRESSHOLDMARGIN=25,a._PRESSHOLDTHRESHOLD=0,a._rmvAtts="id,class,style,draggable".split(","),a._kbdProps="altKey,ctrlKey,metaKey,shiftKey".split(","),a._ptProps="pageX,pageY,clientX,clientY,screenX,screenY".split(","),t.DragDropTouch=a})($||($={}));var h=(t=>(t.rankingsDataSet="rankingsDataSet",t.searchFilterChanged="searchFilterChanged",t.eventFilterChanged="eventFilterChanged",t.eventTypeFilterChanged="eventTypeFilterChanged",t.ageFilterChanged="ageFilterChanged",t.continentFilterChanged="continentFilterChanged",t.countryFilterChanged="countryFilterChanged",t.topNChanged="topNChanged",t.rankingTypeChanged="rankingTypeChanged",t.timeFrameChanged="timeFrameChanged",t.rankingsFiltered="rankingsFiltered",t.resultsSorted="resultsSorted",t.sortColumnsChanged="sortColumnsChanged",t.uiStateSet="uiStateSet",t))(h||{});function Z(t){return{type:h.searchFilterChanged,payload:t}}function z(t){return{type:h.eventFilterChanged,payload:t}}function J(t){return{type:h.eventTypeFilterChanged,payload:t}}function Q(t){return{type:h.ageFilterChanged,payload:t}}function tt(t){return{type:h.continentFilterChanged,payload:t}}function et(t){return{type:h.countryFilterChanged,payload:t}}function nt(t){return{type:h.topNChanged,payload:t}}function rt(t){return{type:h.rankingTypeChanged,payload:t}}function ot(t){return{type:h.timeFrameChanged,payload:t}}function at(t=O.filters,n){const{type:a,payload:r}=n;switch(a){case h.searchFilterChanged:return{...t,search:r};case h.eventFilterChanged:return{...t,event:r};case h.eventTypeFilterChanged:return{...t,eventType:r};case h.ageFilterChanged:return{...t,age:r};case h.continentFilterChanged:return{...t,continent:r};case h.countryFilterChanged:return{...t,country:r};case h.topNChanged:return{...t,topN:r};case h.rankingTypeChanged:return{...t,rankingType:r};case h.timeFrameChanged:return{...t,timeFrame:r}}return t}function it(t,n){return{type:h.rankingsFiltered,payload:{rankings:t,filters:n}}}function st(t,n){return{type:h.resultsSorted,payload:{sortColumns:t,rankingType:n}}}function lt(t=[],n){const{type:a,payload:r}=n;switch(a){case h.rankingsFiltered:return ct(r.rankings,r.filters);case h.resultsSorted:return vt(t,r.sortColumns,r.rankingType)}return t}function ct(t,n){const a=t.data,{competitionIDToIndex:r,personIDToIndex:e,continentIDToIndex:i,countryIDToIndex:l}=t,{topN:s,timeFrame:u}=n,p=24*60*60*1e3,m=[];for(const v of a.events)for(const c of v.rankings){const d={world:0,continents:{},countries:{}};for(const[g,f]of c.ranks.entries()){const y=a.competitions[r[f.competition]];if(!y)throw new Error(`Missing competition ID ${f.competition}`);const k=a.persons[e[f.id]];if(!k)throw new Error(`Missing competitor ID ${f.id}`);const _=a.countries[l[k.country]];if(!_)throw new Error(`Missing country ID ${k.country}`);const C=a.continents[i[_.continent]];if(!C)throw new Error(`Missing continent ID ${_.continent}`);const X=Math.floor((new Date().getTime()-new Date(y.startDate).getTime())/p);d.world++,d.continents[C.id]??=0,d.continents[C.id]++,d.countries[_.id]??=0,d.countries[_.id]++;const S=c.missing?.world??0;let R,D=1,E;n.rankingType==="cr"?(c.missing.continents?.[C.id]?(R=c.missing.continents[C.id],S>0&&(D=R/S)):S>0&&(D=0),E=d.continents[C.id]+D*(f.rank-g-1)):n.rankingType==="nr"?(c.missing.countries?.[_.id]?(R=c.missing.countries[_.id],S>0&&(D=R/S)):S>0&&(D=0),E=d.countries[_.id]+D*(f.rank-g-1)):(R=S,E=d.world+D*(f.rank-g-1)),E=Number(E.toFixed(0));const M={event:v,eventType:c.type,age:c.age,date:y.startDate,rank:E,name:k.name,wcaID:k.id,continent:C,country:_,result:f.best,compName:y.name,compWebID:y.webId,compCountry:y.country};X<=u&&E<=s&&ut(M,n)&&m.push(M)}}return m}function ut(t,n){return mt(t,n.search)&&dt(t,n.event)&&ht(t,n.eventType)&&gt(t,n.age)&&ft(t,n.continent)&&pt(t,n.country)}function dt(t,n){return n?t.event.id===n:!0}function ht(t,n){return n?t.eventType===n:!0}function gt(t,n){return n?t.age>=n:!0}function ft(t,n){return n?t.continent.id===n:!0}function pt(t,n){return n?t.country.id===n:!0}function mt(t,n){return n?[t.date,t.event.id,t.continent.id,t.age,t.event.id,t.country.id,t.age,t.event.id,t.age,t.event.id,t.eventType,t.continent.id,t.age,t.event.id,t.eventType,t.country.id,t.age,t.event.id,t.eventType,t.age,t.name,t.compName].map(e=>String(e)).join(" ").toLowerCase().includes(n.toLowerCase()):!0}function vt(t,n,a){const r=[...t];return[...n].reverse().map(i),r;function i(l){const{name:s,direction:u}=l;function p(c,d){switch(a){case"wr":return u*(c.age-d.age);case"cr":{const g=`${c.continent.id} ${c.age}`,f=`${d.continent.id} ${d.age}`;return u*g.localeCompare(f)}case"nr":{const g=`${c.country.id} ${c.age}`,f=`${d.country.id} ${d.age}`;return u*g.localeCompare(f)}}}function m(c,d){const g=["333","222","444","555","666","777","333bf","333fm","333oh","clock","minx","pyram","skewb","sq1","444bf","555bf","333mbf"],f=g.indexOf(c.event.id),y=g.indexOf(d.event.id);return f===y&&c.eventType!==d.eventType?u*(c.eventType==="single"?-1:1):u*(f-y)}function v(c,d){if(c.event.format!==d.event.format)return c.event.format==="time"||d.event.format==="time"?u*(c.event.format==="time"?-1:1):u*(c.event.format==="number"?-1:1);switch(c.event.format){case"time":{const[g,f]=[c.result,d.result].map(K);return u*(g-f)}case"number":return u*(Number(c.result)-Number(d.result));case"multi":{const[g,f]=[c.result,d.result].map(B);return g.score!==f.score?-u*(g.score-f.score):g.seconds!==f.seconds?u*(g.seconds-f.seconds):u*(g.unsolved-f.unsolved)}}}switch(s){case"date":case"name":r.sort((c,d)=>u*c[s].localeCompare(d[s]));break;case"rank":r.sort((c,d)=>u*(c[s]-d[s]));break;case"event":r.sort(m);break;case"group":r.sort(p);break;case"result":r.sort(v);break}return r}}function L(t){return{type:h.sortColumnsChanged,payload:t}}function yt(t=[],n){const{type:a,payload:r}=n;switch(a){case h.sortColumnsChanged:return _t(t,r)}return t}function _t(t,n){const a=[...t],r=t.findIndex(e=>e.name===n.name);return r<0?(a[n.position]={name:n.name,label:n.label,direction:n.defaultDirection||1},a):r===n.position?(a[n.position].direction*=-1,a):(a.splice(r,1),a.splice(n.position,0,t[r]),a)}function bt(t){return{type:h.uiStateSet,payload:t}}function Ct(t=O.uiState,n){const{type:a,payload:r}=n;switch(a){case h.uiStateSet:return r}return t}const O={rankings:{lastUpdated:"",data:{},competitionIDToIndex:{},personIDToIndex:{},continentIDToIndex:{},countryIDToIndex:{},activeRegions:{continents:[],countries:[]}},results:[],filters:{search:"",event:"",eventType:"",age:"",continent:"",country:"",topN:10,rankingType:"wr",timeFrame:30},sortColumns:[{name:"date",label:"Date",direction:-1},{name:"rank",label:"Rank",direction:1},{name:"event",label:"Event",direction:1}],uiState:{scrollX:0,scrollY:0,activeID:null}},St=j({rankings:W,results:lt,filters:at,sortColumns:yt,uiState:Ct});function Dt(t=O,n){return St(t,n)}function Et(t){return o.h("div",{id:"info"},o.h("p",{class:"refreshed"},"Last refreshed: ",t.lastUpdated," (UTC)"),o.h("p",null,"Drag the columns in the sort column list to rearrange the sort order. Column headers can be dragged to the list to change the sort columns. You can also click a column header to set the primary sort, ctrl-click to set the secondary sort, and ctrl+shift-click to set the tertiary sort."))}function Tt(){const t=["40, 50, 60, etc.","competitor name","competition name"];return"e.g. "+t[Math.floor(Math.random()*t.length)]}function kt(t){const{store:n,handleRender:a}=t,{search:r}=n.getState().filters;function e(i){const l=i.target;n.dispatch(Z(l.value)),a()}return o.h("div",{id:"search"},o.h("label",{class:"strong"},"Search:"),o.h("input",{id:"search-input",value:r,onInput:G(e,350),type:"search",size:19,placeholder:Tt()}))}function b(t,n){return t.map(a=>o.h("option",{value:a.value,selected:a.value==n},a.label))}function Rt(t){const{store:n,handleRender:a}=t,{event:r}=n.getState().filters,e=[];for(const l of n.getState().rankings.data.events)e.push({label:l.name,value:l.id});function i(){n.dispatch(z(this.value)),a()}return o.h("div",null,o.h("label",{class:"strong"},"Event:"),o.h("select",{id:"event-filter",onChange:i},o.h("option",{value:""},"All Events"),b(e,r)))}function It(t){const{store:n,handleRender:a}=t,{rankings:r,filters:e}=n.getState(),{continent:i,country:l}=e,{countryIDToIndex:s}=r,{continents:u,countries:p}=r.data,m=new Set(r.activeRegions.continents),v=[];function c(){n.dispatch(tt(this.value)),a()}let d;if(l){const g=p[s[l]];d=u.filter(f=>g.continent===f.id)}else d=u.filter(g=>m.has(g.id));for(const g of d)v.push({label:g.name,value:g.id});return o.h("div",null,o.h("label",{class:"strong"},"Continent:"),o.h("select",{id:"continent-filter",onChange:c},o.h("option",{value:""},"All Continents"),b(v,i)))}function Ft(t){const{store:n,handleRender:a}=t,{rankings:r,filters:e}=n.getState(),i=r.data.countries,l=new Set(r.activeRegions.countries),s=e.country,u=e.continent;function p(){n.dispatch(et(this.value)),a()}const m=i.filter(c=>l.has(c.id)).filter(c=>u===""||c.continent===u),v=[];for(const c of m)v.push({label:c.name,value:c.id});return o.h("div",null,o.h("label",{class:"strong"},"Country:"),o.h("select",{id:"country-filter",onChange:p},o.h("option",{value:""},"All Countries"),b(v,s)))}const Ot=[{value:"5",label:"5"},{value:"10",label:"10"},{value:"25",label:"25"},{value:"50",label:"50"}],wt=[{value:"wr",label:"World (WR)"},{value:"cr",label:"Continent (CR)"},{value:"nr",label:"National (NR)"}],Pt=[{value:"7",label:"7 days"},{value:"14",label:"14 days"},{value:"30",label:"30 days"},{value:"60",label:"60 days"},{value:"90",label:"90 days"}];function Ht(t){const{store:n,handleRender:a}=t,{timeFrame:r,topN:e,rankingType:i}=n.getState().filters;function l(){n.dispatch(ot(Number(this.value))),a()}function s(){n.dispatch(nt(Number(this.value))),a()}function u(){n.dispatch(rt(this.value)),a()}return o.h("div",{id:"parameters"},o.h("div",null,o.h("label",{class:"strong"},"Top:"),o.h("select",{id:"top-n",onChange:s},b(Ot,e))),o.h("div",null,o.h("label",{class:"strong"},"Ranking Type:"),o.h("select",{id:"ranking-type-filter",onChange:u},b(wt,i))),o.h("div",null,o.h("label",{class:"strong"},"Time frame:"),o.h("select",{id:"time-frame",onChange:l},b(Pt,r))))}let w,x,I;function Lt(t){return w=t.store,x=t.handleRender,o.h("div",{id:"sort-columns"},o.h("div",{class:"strong"},"Sort:"),w.getState().sortColumns.map(xt))}function xt(t,n){const a=["primary","secondary","tertiary"],r=t.direction==1?"ascending":"descending";return o.h("button",{onClick:Nt,onDragStart:A,onDragEnter:$t,onDragOver:Mt,onDragLeave:At,onDrop:Ut,onDragEnd:U,class:`sort-column ${r} ${a[n]} strong`,draggable:"true","data-sort-on":t.name,"data-position":n},t.label,o.h("span",{"aria-hidden":"true"}))}function Nt(t){const n=t.currentTarget,a=String(n.dataset.sortOn),r=String(n.textContent).trim(),e=Number(n.dataset.position);w.dispatch(L({name:a,label:r,position:e,defaultDirection:null})),x()}function A(t){const n=t.currentTarget,a=t.dataTransfer;I=n,n.style.opacity="0.4",a.effectAllowed="move"}function Mt(t){const n=t.dataTransfer;t.preventDefault(),n.dropEffect="move"}function $t(t){t.currentTarget.classList.add("over")}function At(t){t.currentTarget.classList.remove("over")}function Ut(t){const n=t.currentTarget;if(t.stopPropagation(),n.classList.remove("over"),I.dataset.sortOn!==n.dataset.sortOn){const a=I.querySelector("span.text"),r=String(I.dataset.sortOn),e=String(a?.textContent).trim(),i=Number(n.dataset.position),l=Number(I.dataset.defaultDirection)||null;w.dispatch(L({name:r,label:e,position:i,defaultDirection:l})),x()}}function U(t){t.currentTarget.removeAttribute("style")}function Yt(t){const{store:n,handleRender:a}=t,{eventType:r}=n.getState().filters;function e(){n.dispatch(J(this.value)),a()}const i=[{label:"Single",value:"single"},{label:"Average",value:"average"}];return o.h("div",null,o.h("label",{class:"strong"},"Result:"),o.h("select",{id:"event-type-filter",onChange:e},o.h("option",{value:""},"Any"),b(i,r)))}function Xt(t){const{store:n,handleRender:a}=t,{age:r}=n.getState().filters;function e(){n.dispatch(Q(Number(this.value))),a()}const i=[{label:"Over 40",value:"40"},{label:"Over 50",value:"50"},{label:"Over 60",value:"60"},{label:"Over 70",value:"70"},{label:"Over 80",value:"80"},{label:"Over 90",value:"90"}];return o.h("div",null,o.h("label",{class:"strong"},"Age:"),o.h("select",{id:"age-filter",onChange:e},b(i,r)))}function Bt(t){return o.h("div",{id:"panel"},o.h("div",{class:"panel-grid"},o.h(Ht,{...t}),o.h(Kt,{...t}),o.h(Lt,{...t})))}function Kt(t){return o.h("div",{id:"dropdown-filters"},o.h(Rt,{...t}),o.h(Yt,{...t}),o.h(Xt,{...t}),o.h(It,{...t}),o.h(Ft,{...t}),o.h(kt,{...t}))}const jt=[{name:"date",label:"Date",defaultSortDirection:-1},{name:"event",label:"Event",defaultSortDirection:1},{name:"group",label:"Group",defaultSortDirection:1},{name:"rank",label:"Rank",defaultSortDirection:1},{name:"name",label:"Name",defaultSortDirection:1},{name:"result",label:"Result",defaultSortDirection:1},{name:"competition",label:"Competition",defaultSortDirection:null}];function Wt(t){const{results:n}=t.store.getState();return!n||n.length===0?Qt():Gt(t)}function Gt(t){const{results:n}=t.store.getState(),a=[];for(const r of n)a.push(o.h(Jt,{rowData:r,appProps:t}));return o.h("table",{id:"ranking-table",class:"rankings sortable"},o.h("thead",null,o.h(Vt,{headers:jt,appProps:t})),o.h("tbody",null,a))}function Vt(t){const{headers:n,appProps:a}=t,r=[];for(const e of n)r.push(o.h(qt,{columnHeader:e,appProps:a}));return o.h("tr",null,r)}function qt(t){const{columnHeader:n,appProps:a}=t;return n.defaultSortDirection===null?o.h(zt,{columnHeader:n}):o.h(Zt,{columnHeader:n,appProps:a})}function Zt(t){const{columnHeader:n,appProps:a}=t,{sortColumns:r}=a.store.getState();function e(s){const u=(s.ctrlKey?1:0)+(s.shiftKey?1:0);a.store.dispatch(L({name:n.name,label:n.label,position:u,defaultDirection:n.defaultSortDirection})),a.handleRender()}const i=[n.name];let l=null;for(const[s,u]of r.entries())if(u.name===n.name){const p=u.direction==1?"ascending":"descending",m=["primary","secondary","tertiary"];i.push(p),i.push(m[s]),s===0&&(l=p)}return o.h("th",{draggable:"true",class:i.join(" "),"data-sort-on":n.name,"data-default-direction":n.defaultSortDirection,"aria-sort":l,onClick:e,onDragStart:A,onDragEnd:U},o.h("button",{class:"strong",type:"button"},o.h("div",{class:"column"},o.h("span",{class:"text"},n.label)),o.h("div",{class:"column"},o.h("span",{class:"sort up","aria-hidden":"true"},"▲"),o.h("span",{class:"sort down","aria-hidden":"true"},"▼"))))}function zt(t){return o.h("th",{class:`${t.columnHeader.name} no-sort strong`},o.h("span",null,t.columnHeader.label))}function Jt(t){const n="https://www.worldcubeassociation.org/persons",a="https://www.worldcubeassociation.org/competitions",r="https://wca-seniors.org/Senior_Rankings.html",{rowData:e,appProps:i}=t,l=i.store.getState().filters.rankingType,s=e.date.indexOf("-"),u=e.date.slice(0,s+1),p=e.date.slice(s+1),m=`${n}/${e.wcaID}?event=${e.event.id}`,v=`${a}/${e.compWebID}/results/by_person#${e.wcaID}`,c=`${r}#${e.event.id}-${e.eventType}-${e.age}`;let d;switch(l){case"wr":{d=o.h("a",{href:c,target:"_blank"},e.age,"+");break}case"cr":{d=o.h("a",{href:c+`-${e.continent.id}`,target:"_blank"},e.continent.id," ",e.age,"+");break}case"nr":{d=o.h("a",{href:c+`-xx-${e.country.id}`,target:"_blank"},e.country.id," ",e.age,"+");break}}return o.h("tr",null,o.h("td",{class:"date"},u,o.h("wbr",null),p),o.h("td",{class:"event"},o.h("i",{class:`event-${e.event.id} cubing-icon icon`}),e.event.id," ",e.eventType),o.h("td",{class:"group"},d),o.h("td",{class:"rank"},e.rank),o.h("td",{class:"name"},o.h("a",{href:m,target:"_blank"},o.h("span",{class:`flag-${e.country.id} flag`})," ",e.name)),o.h("td",{class:"result"},e.result),o.h("td",{class:"competition"},o.h("a",{href:v,target:"_blank"},o.h("span",{class:`flag-${e.compCountry} flag`})," ",e.compName)))}function Qt(){return o.h("h3",{class:"no-results"},"No results")}function te(t){const a=t.store.getState(),r=a.results;return o.h("div",null,o.h(Et,{lastUpdated:a.rankings.lastUpdated}),o.h(Bt,{...t}),o.h("div",{class:"strong"},"Showing ",r.length," ",r.length===1?"result":"results"),o.h(Wt,{...t}))}function ee(){return o.h("h3",{class:"message"},"Loading... please wait")}function H(t){return o.h("div",{class:"error"},o.h("h3",null,"Something went wrong ™"),o.h("div",{class:"message"},t))}function ne(t){return{type:h.rankingsDataSet,payload:t}}const F=V("#app");let N;const re="../data/senior-rankings.json",P=await fetch(re);try{if(!P.ok)throw F.render(H("The rankings data is missing, try back in a bit.")),new Error(`Fetch response: ${P.statusText}`);N=await P.json()}catch(t){throw F.render(H("The rankings data is missing, try back in a bit.")),t}const T=q({...O,rankings:N},Dt);T.dispatch(ne(N));Y();function Y(){try{const t=T.getState();T.dispatch(bt(oe())),F.render(ee()),T.dispatch(it(t.rankings,t.filters)),T.dispatch(st(t.sortColumns,t.filters.rankingType)),F.render(te({store:T,handleRender:Y})),ae(t.uiState)}catch(t){throw t instanceof Error&&F.render(H(t.message)),t}}function oe(){const t=O.uiState;t.scrollX=window.scrollX,t.scrollY=window.scrollY,t.activeID=document.activeElement?.id||null;const n=document.getElementById("search-input");return t.selectionStart=n?.selectionStart,t.selectionEnd=n?.selectionEnd,t.selectionDirection=n?.selectionDirection,t}function ae(t){if(t.activeID&&document.getElementById(t.activeID)?.focus(),t.activeID==="search-input"){const n=document.getElementById("search-input");n.selectionStart=t?.selectionStart||null,n.selectionEnd=t?.selectionEnd||null,n.selectionDirection=t?.selectionDirection||"none"}window.scroll(t.scrollX,t.scrollY)}
